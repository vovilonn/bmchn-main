"use strict";

jQuery(function ($) {
  $(document).ready(function () {
    // Handler for opening the popup
    $('.js-page-nav li a').click(function (e) {
      e.preventDefault();
      var index = $(this).attr('data-page-nav-index');

      // Check if the preference to not show popup is set in localStorage
      if (localStorage.getItem('noShowPopup') === 'true') {
        return; // Exit the function if the preference is set
      }

      // Remove --active class from all popups
      $('.js-page-nav-inner').removeClass('--active');

      // Now add --active class only to the clicked popup
      $('.js-page-nav-popup').addClass('--active');
      $('.js-page-nav-popup .js-page-nav-inner[data-page-nav-index="' + index + '"]').addClass('--active');
    });

    // Handler for closing the popup normally
    $('.js-page-nav-popup .js-close').click(function () {
      $('.js-page-nav-popup, .js-page-nav-inner').removeClass('--active');
    });

    // Handler for the hard close button
    $('.js-page-nav-popup .js-close-hard').click(function () {
      $('.js-page-nav-popup, .js-page-nav-inner').removeClass('--active');
      localStorage.setItem('noShowPopup', 'true'); // Save preference in localStorage
    });
  });

  $(document).ready(function () {
    $('.js-page-nav li a').click(function (e) {
      e.preventDefault();
      var index = $(this).attr('data-page-nav-index');
      if (!localStorage.getItem('noShowPopup')) {
        $('.js-page-nav-inner').removeClass('--active');
        $('.js-page-nav-popup').addClass('--active');
        $('.js-page-nav-popup .js-page-nav-inner[data-page-nav-index="' + index + '"]').addClass('--active');
      } else {
        window.location = this.href;
      }
    });
    $('.btn-arrow').click(function () {
      var item = $(this).closest('.vacancies__item');
      var imageSrc = item.find('.vacancies__img img').attr('src');
      var text = item.find('.vacancies__img span').text();
      var popupContent = '<div class="vacancy-popup-content">' + '<img src="' + imageSrc + '" alt="Vacancy Image">' + " <div class=\"vacancy-popup-text-container\">\n                               <h2>\u0412\u0410\u041A\u0410\u041D\u0421\u0418\u042F</h2>\n                               <h1>".concat(text.toUpperCase(), "</h1>\n                               <p class=\"vacancy-popup-info\">\n                                   \u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438. \u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438.\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438.\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438.\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438.\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438.\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438.\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438.\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438.\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438.\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438.\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438.\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438.\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u0430\u043A\u0430\u043D\u0441\u0438\u0438.\n                               </p> ") + "                               <div class=\"vacancy-popup-request\">\n                                <a class=\"btn\">\n                                    <span>\u041F\u043E\u0434\u0430\u0442\u044C \u0437\u0430\u044F\u0432\u043A\u0443</span>\n                                </a>\n                                <span class=\"request-hint\">\n                                \u0417\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u0437\u0430\u044F\u0432\u043A\u0443 \u0432 \u043D\u0430\u0448\u0435\u043C Telegram-\u0431\u043E\u0442\u0435.\n                                </span>\n                                </div>\n                              </div>" + '<span class="close-btn">&times;</span>' + '</div>';
      console.log(popupContent);
      $('.vacancy-popup').html(popupContent).addClass('show');
      $('.close-btn').click(function () {
        $('.vacancy-popup').removeClass('show');
      });
    });
    $('.js-page-nav-popup .js-close').click(function () {
      $('.js-page-nav-popup, .js-page-nav-inner').removeClass('--active');
    });
    $("video[autoplay]").each(function () {
      this.play();
    });
    if (innerWidth > 1024) {
      var mainSlider = new Swiper('.main-slider .swiper-container', {
        direction: 'vertical',
        mousewheel: true,
        slidesPerView: 1,
        pagination: {
          el: '.swiper-pagination',
          clickable: true
        },
        on: {
          slideChange: function slideChange() {
            var index_currentSlide = this.realIndex;
            $('.js-main-slider-tabs li button').removeClass('active');
            $('.js-main-slider-tabs li button[data-slide-index=' + (index_currentSlide + 1) + ']').addClass('active');
          }
        }
      });
      $('.js-main-slider-tabs li button').click(function () {
        var index = $(this).attr('data-slide-index');
        $('.js-main-slider-tabs li button').removeClass('active');
        $(this).addClass('active');
        $('.main-slider .swiper-pagination-bullet:nth-child(' + index + ')').click();
      });
    }
    $('.js-nav-open').click(function () {
      $(this).toggleClass('active');
      $('.js-header-nav').toggleClass('active');
    });
    $('.js-services-popup-opener').click(function () {
      var index = $(this).attr('data-tab-index');
      $('.js-services-popup').addClass('active');
      $('.js-services-popup-nav button, .js-services-popup-container').removeClass('active');
      $('.js-services-popup-nav button[data-tab-index="' + index + '"]').addClass('active');
      $('.js-services-popup-container[data-tab-index="' + index + '"]').addClass('active');
    });
    $('.js-services-popup-nav button').click(function () {
      var index = $(this).attr('data-tab-index');
      $('.js-services-popup-nav button, .js-services-popup-container').removeClass('active');
      $('.js-services-popup-nav button[data-tab-index="' + index + '"]').addClass('active');
      $('.js-services-popup-container[data-tab-index="' + index + '"]').addClass('active');
    });
    $('.js-services-popup-close').click(function () {
      $('.js-services-popup').removeClass('active');
    });
    $('.js-store-tabs button').click(function () {
      var index = $(this).attr('data-store-slider-index');
      $('.js-store-tabs button, .js-store-slider').removeClass('active');
      $('.js-store-slider[data-store-slider-index="' + index + '"]').addClass('active');
      $('.js-store-tabs button[data-store-slider-index="' + index + '"]').addClass('active');
    });
    var storeSliders = $('.js-store-slider');
    if (storeSliders.length) {
      storeSliders.each(function () {
        var index = $(this).attr('data-store-slider-index');
        var storeSlider = new Swiper('.js-store-slider[data-store-slider-index="' + index + '"] .swiper-container', {
          direction: 'horizontal',
          mousewheel: false,
          slidesPerView: 1.8,
          spaceBetween: 12,
          pagination: false,
          navigation: {
            nextEl: '.js-store-slider[data-store-slider-index="' + index + '"] .js-store-slider-next',
            prevEl: '.js-store-slider[data-store-slider-index="' + index + '"] .js-store-slider-prev'
          },
          breakpoints: {
            768: {
              slidesPerView: 4
            }
          }
        });
      });
    }
    var teamSlider = new Swiper('.js-team-slider .swiper-container', {
      direction: 'horizontal',
      mousewheel: false,
      slidesPerView: 1.1,
      spaceBetween: 12,
      pagination: false,
      navigation: {
        nextEl: '.js-team-slider-next',
        prevEl: '.js-team-slider-prev'
      },
      breakpoints: {
        768: {
          slidesPerView: 3
        }
      }
    });
    $(window).on('scroll', function () {
      var st = $(window).scrollTop();
      var section = $('.biomachine-future');
      var sectionST = section.offset().top;
      var sectionHeight = section.height();
      var windowHeight = $(window).height();
      var point = sectionST + sectionHeight;
      if (st >= point) {
        console.log('change footer');
        $('.footer').addClass('--visible');
        $('.biomachine-string__bg').addClass('--visible');
        $('.js-page-nav').addClass('--hidden');
      } else {
        $('.biomachine-string__bg').removeClass('--visible');
        $('.footer').removeClass('--visible');
        $('.js-page-nav').removeClass('--hidden');
      }
    });
    $(window).on('scroll', function () {
      var st = $(window).scrollTop();
      var section = $('.js-store-section');
      var sectionST = section.offset().top;
      var point = sectionST - 400;
      if (st >= point) {
        section.removeClass('--inverted');
        $('.biomachine-promo.--last').addClass('--inverted');
      } else {
        section.addClass('--inverted');
        $('.biomachine-promo.--last').removeClass('--inverted');
      }
    });
    $('.biomachine-string__item').each(function () {
      var item = this;
      $(window).on('scroll', function () {
        var height = $(window).height();
        height = height - 150;
        var viewportOffset = item.getBoundingClientRect();
        var top = viewportOffset.top - height;
        if (top + 150 <= 0 && top + 150 >= -Math.abs(height / 2)) {
          var percent = top * 100 / height;
          percent = +Math.abs(percent);
          percent = Math.round(percent);
          var value = 0;
          value = percent * 2;
          $(item).css('opacity', value / 100);
          if (percent >= 40) {
            $(item).removeClass('--opacity');
          }
        }
        if (top + 150 <= -Math.abs(height / 2) && top + 150 >= -Math.abs(height)) {
          var _percent = top * 100 / height;
          _percent = +Math.abs(_percent);
          _percent = Math.round(_percent);
          var _value = 0;
          if (_percent >= 50 && _percent < 55) {
            _value = 0.9;
          } else if (_percent >= 55 && _percent < 60) {
            _value = 0.8;
          } else if (_percent >= 60 && _percent < 65) {
            _value = 0.7;
          } else if (_percent >= 65 && _percent < 70) {
            _value = 0.6;
          } else if (_percent >= 70 && _percent < 75) {
            _value = 0.5;
          } else if (_percent >= 75 && _percent < 80) {
            _value = 0.4;
          } else if (_percent >= 80 && _percent < 85) {
            _value = 0.3;
          } else if (_percent >= 85 && _percent < 90) {
            _value = 0.2;
          } else if (_percent >= 90 && _percent < 95) {
            _value = 0.1;
          } else if (_percent >= 90 && _percent < 100) {
            _value = 0;
          }
          if ($(item).hasClass('--last')) {
            $('.biomachine-string__bg').css('opacity', _value);
          }
          $(item).css('opacity', _value);
        }
      });
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdlbmVyYWwuanMiXSwibmFtZXMiOlsialF1ZXJ5IiwiJCIsImRvY3VtZW50IiwicmVhZHkiLCJjbGljayIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImluZGV4IiwiYXR0ciIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwic2V0SXRlbSIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsIml0ZW0iLCJjbG9zZXN0IiwiaW1hZ2VTcmMiLCJmaW5kIiwidGV4dCIsInBvcHVwQ29udGVudCIsImNvbmNhdCIsInRvVXBwZXJDYXNlIiwiY29uc29sZSIsImxvZyIsImh0bWwiLCJlYWNoIiwicGxheSIsImlubmVyV2lkdGgiLCJtYWluU2xpZGVyIiwiU3dpcGVyIiwiZGlyZWN0aW9uIiwibW91c2V3aGVlbCIsInNsaWRlc1BlclZpZXciLCJwYWdpbmF0aW9uIiwiZWwiLCJjbGlja2FibGUiLCJvbiIsInNsaWRlQ2hhbmdlIiwiaW5kZXhfY3VycmVudFNsaWRlIiwicmVhbEluZGV4IiwidG9nZ2xlQ2xhc3MiLCJzdG9yZVNsaWRlcnMiLCJsZW5ndGgiLCJzdG9yZVNsaWRlciIsInNwYWNlQmV0d2VlbiIsIm5hdmlnYXRpb24iLCJuZXh0RWwiLCJwcmV2RWwiLCJicmVha3BvaW50cyIsInRlYW1TbGlkZXIiLCJzdCIsInNjcm9sbFRvcCIsInNlY3Rpb24iLCJzZWN0aW9uU1QiLCJvZmZzZXQiLCJ0b3AiLCJzZWN0aW9uSGVpZ2h0IiwiaGVpZ2h0Iiwid2luZG93SGVpZ2h0IiwicG9pbnQiLCJ2aWV3cG9ydE9mZnNldCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIk1hdGgiLCJhYnMiLCJwZXJjZW50Iiwicm91bmQiLCJ2YWx1ZSIsImNzcyIsImhhc0NsYXNzIl0sIm1hcHBpbmdzIjoiOztBQUFBQSxNQUFNLENBQUMsVUFBVUMsQ0FBQyxFQUFFO0VBRWhCQSxDQUFDLENBQUNDLFFBQVEsQ0FBQyxDQUFDQyxLQUFLLENBQUMs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UUFBTyxHQUFHLEVBQUUsRUFBRTtZQUN0Q0UsTUFBSyxHQUFHLEdBQUc7VUFDZixDQUFDLE1BQU0sSUFBSUYsUUFBTyxJQUFJLEVBQUUsSUFBSUEsUUFBTyxHQUFHLEVBQUUsRUFBRTtZQUN0Q0UsTUFBSyxHQUFHLEdBQUc7VUFDZixDQUFDLE1BQU0sSUFBSUYsUUFBTyxJQUFJLEVBQUUsSUFBSUEsUUFBTyxHQUFHLEVBQUUsRUFBRTtZQUN0Q0UsTUFBSyxHQUFHLEdBQUc7VUFDZixDQUFDLE1BQU0sSUFBSUYsUUFBTyxJQUFJLEVBQUUsSUFBSUEsUUFBTyxHQUFHLEVBQUUsRUFBRTtZQUN0Q0UsTUFBSyxHQUFHLEdBQUc7VUFDZixDQUFDLE1BQU0sSUFBSUYsUUFBTyxJQUFJLEVBQUUsSUFBSUEsUUFBTyxHQUFHLEVBQUUsRUFBRTtZQUN0Q0UsTUFBSyxHQUFHLEdBQUc7VUFDZixDQUFDLE1BQU0sSUFBSUYsUUFBTyxJQUFJLEVBQUUsSUFBSUEsUUFBTyxHQUFHLEVBQUUsRUFBRTtZQUN0Q0UsTUFBSyxHQUFHLEdBQUc7VUFDZixDQUFDLE1BQU0sSUFBSUYsUUFBTyxJQUFJLEVBQUUsSUFBSUEsUUFBTyxHQUFHLEdBQUcsRUFBRTtZQUN2Q0UsTUFBSyxHQUFHLENBQUM7VUFDYjtVQUVBLElBQUlwRSxDQUFDLENBQUNnQixJQUFJLENBQUMsQ0FBQ3NELFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUM1QnRFLENBQUMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDcUUsR0FBRyxDQUFDLFNBQVMsRUFBRUQsTUFBSyxDQUFDO1VBQ3JEO1VBRUFwRSxDQUFDLENBQUNnQixJQUFJLENBQUMsQ0FBQ3FELEdBQUcsQ0FBQyxTQUFTLEVBQUVELE1BQUssQ0FBQztRQUNqQztNQUNKLENBQUMsQ0FBQztJQUNOLENBQUMsQ0FBQztFQUVOLENBQUMsQ0FBQztBQUNOLENBQUMsQ0FBQyIsImZpbGUiOiJidWlsZC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJqUXVlcnkoZnVuY3Rpb24gKCQpIHtcblxuICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBIYW5kbGVyIGZvciBvcGVuaW5nIHRoZSBwb3B1cFxuICAgICAgICAkKCcuanMtcGFnZS1uYXYgbGkgYScpLmNsaWNrKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBsZXQgaW5kZXggPSAkKHRoaXMpLmF0dHIoJ2RhdGEtcGFnZS1uYXYtaW5kZXgnKTtcbiAgICBcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBwcmVmZXJlbmNlIHRvIG5vdCBzaG93IHBvcHVwIGlzIHNldCBpbiBsb2NhbFN0b3JhZ2VcbiAgICAgICAgICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbm9TaG93UG9wdXAnKSA9PT0gJ3RydWUnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBFeGl0IHRoZSBmdW5jdGlvbiBpZiB0aGUgcHJlZmVyZW5jZSBpcyBzZXRcbiAgICAgICAgICAgIH1cbiAgICBcbiAgICAgICAgICAgIC8vIFJlbW92ZSAtLWFjdGl2ZSBjbGFzcyBmcm9tIGFsbCBwb3B1cHNcbiAgICAgICAgICAgICQoJy5qcy1wYWdlLW5hdi1pbm5lcicpLnJlbW92ZUNsYXNzKCctLWFjdGl2ZScpO1xuICAgIFxuICAgICAgICAgICAgLy8gTm93IGFkZCAtLWFjdGl2ZSBjbGFzcyBvbmx5IHRvIHRoZSBjbGlja2VkIHBvcHVwXG4gICAgICAgICAgICAkKCcuanMtcGFnZS1uYXYtcG9wdXAnKS5hZGRDbGFzcygnLS1hY3RpdmUnKTtcbiAgICAgICAgICAgICQoJy5qcy1wYWdlLW5hdi1wb3B1cCAuanMtcGFnZS1uYXYtaW5uZXJbZGF0YS1wYWdlLW5hdi1pbmRleD1cIicgKyBpbmRleCArICdcIl0nKS5hZGRDbGFzcygnLS1hY3RpdmUnKTtcbiAgICAgICAgfSk7XG4gICAgXG4gICAgICAgIC8vIEhhbmRsZXIgZm9yIGNsb3NpbmcgdGhlIHBvcHVwIG5vcm1hbGx5XG4gICAgICAgICQoJy5qcy1wYWdlLW5hdi1wb3B1cCAuanMtY2xvc2UnKS5jbGljayhmdW5jdGlvbiAoKXtcbiAgICAgICAgICAgICQoJy5qcy1wYWdlLW5hdi1wb3B1cCwgLmpzLXBhZ2UtbmF2LWlubmVyJykucmVtb3ZlQ2xhc3MoJy0tYWN0aXZlJyk7XG4gICAgICAgIH0pO1xuICAgIFxuICAgICAgICAvLyBIYW5kbGVyIGZvciB0aGUgaGFyZCBjbG9zZSBidXR0b25cbiAgICAgICAgJCgnLmpzLXBhZ2UtbmF2LXBvcHVwIC5qcy1jbG9zZS1oYXJkJykuY2xpY2soZnVuY3Rpb24gKCl7XG4gICAgICAgICAgICAkKCcuanMtcGFnZS1uYXYtcG9wdXAsIC5qcy1wYWdlLW5hdi1pbm5lcicpLnJlbW92ZUNsYXNzKCctLWFjdGl2ZScpO1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ25vU2hvd1BvcHVwJywgJ3RydWUnKTsgLy8gU2F2ZSBwcmVmZXJlbmNlIGluIGxvY2FsU3RvcmFnZVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBcbiAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgJCgnLmpzLXBhZ2UtbmF2IGxpIGEnKS5jbGljayhmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgbGV0IGluZGV4ID0gJCh0aGlzKS5hdHRyKCdkYXRhLXBhZ2UtbmF2LWluZGV4Jyk7XG4gICAgICAgICAgICBpZighbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ25vU2hvd1BvcHVwJykpe1xuICAgICAgICAgICAgICAgICQoJy5qcy1wYWdlLW5hdi1pbm5lcicpLnJlbW92ZUNsYXNzKCctLWFjdGl2ZScpO1xuICAgICAgICAgICAgICAgICQoJy5qcy1wYWdlLW5hdi1wb3B1cCcpLmFkZENsYXNzKCctLWFjdGl2ZScpO1xuICAgICAgICAgICAgICAgICQoJy5qcy1wYWdlLW5hdi1wb3B1cCAuanMtcGFnZS1uYXYtaW5uZXJbZGF0YS1wYWdlLW5hdi1pbmRleD1cIicgKyBpbmRleCArICdcIl0nKS5hZGRDbGFzcygnLS1hY3RpdmUnKTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IHRoaXMuaHJlZlxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiBcbiAgICAgICAgJCgnLmJ0bi1hcnJvdycpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICB2YXIgaXRlbSA9ICQodGhpcykuY2xvc2VzdCgnLnZhY2FuY2llc19faXRlbScpO1xuICAgICAgICAgICAgdmFyIGltYWdlU3JjID0gaXRlbS5maW5kKCcudmFjYW5jaWVzX19pbWcgaW1nJykuYXR0cignc3JjJyk7XG4gICAgICAgICAgICB2YXIgdGV4dCA9IGl0ZW0uZmluZCgnLnZhY2FuY2llc19faW1nIHNwYW4nKS50ZXh0KCk7XG4gICAgXG4gICAgICAgICAgICB2YXIgcG9wdXBDb250ZW50ID0gJzxkaXYgY2xhc3M9XCJ2YWNhbmN5LXBvcHVwLWNvbnRlbnRcIj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8aW1nIHNyYz1cIicgKyBpbWFnZVNyYyArICdcIiBhbHQ9XCJWYWNhbmN5IEltYWdlXCI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCA8ZGl2IGNsYXNzPVwidmFjYW5jeS1wb3B1cC10ZXh0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMj7QktCQ0JrQkNCd0KHQmNCvPC9oMj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDE+JHt0ZXh0LnRvVXBwZXJDYXNlKCl9PC9oMT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz1cInZhY2FuY3ktcG9wdXAtaW5mb1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDQntC/0LjRgdCw0L3QuNC1INCy0LDQutCw0L3RgdC40LguINCe0L/QuNGB0LDQvdC40LUg0LLQsNC60LDQvdGB0LjQuC7QntC/0LjRgdCw0L3QuNC1INCy0LDQutCw0L3RgdC40Lgu0J7Qv9C40YHQsNC90LjQtSDQstCw0LrQsNC90YHQuNC4LtCe0L/QuNGB0LDQvdC40LUg0LLQsNC60LDQvdGB0LjQuC7QntC/0LjRgdCw0L3QuNC1INCy0LDQutCw0L3RgdC40Lgu0J7Qv9C40YHQsNC90LjQtSDQstCw0LrQsNC90YHQuNC4LtCe0L/QuNGB0LDQvdC40LUg0LLQsNC60LDQvdGB0LjQuC7QntC/0LjRgdCw0L3QuNC1INCy0LDQutCw0L3RgdC40Lgu0J7Qv9C40YHQsNC90LjQtSDQstCw0LrQsNC90YHQuNC4LtCe0L/QuNGB0LDQvdC40LUg0LLQsNC60LDQvdGB0LjQuC7QntC/0LjRgdCw0L3QuNC1INCy0LDQutCw0L3RgdC40Lgu0J7Qv9C40YHQsNC90LjQtSDQstCw0LrQsNC90YHQuNC4LtCe0L/QuNGB0LDQvdC40LUg0LLQsNC60LDQvdGB0LjQuC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+IGArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInZhY2FuY3ktcG9wdXAtcmVxdWVzdFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz1cImJ0blwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+0J/QvtC00LDRgtGMINC30LDRj9Cy0LrRgzwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInJlcXVlc3QtaGludFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDQl9Cw0L/QvtC70L3QuNGC0LUg0LfQsNGP0LLQutGDINCyINC90LDRiNC10LwgVGVsZWdyYW0t0LHQvtGC0LUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwiY2xvc2UtYnRuXCI+JnRpbWVzOzwvc3Bhbj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JztcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwb3B1cENvbnRlbnQpO1xuICAgICAgICAgICAgJCgnLnZhY2FuY3ktcG9wdXAnKS5odG1sKHBvcHVwQ29udGVudCkuYWRkQ2xhc3MoJ3Nob3cnKTtcbiAgICBcbiAgICAgICAgICAgICQoJy5jbG9zZS1idG4nKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkKCcudmFjYW5jeS1wb3B1cCcpLnJlbW92ZUNsYXNzKCdzaG93Jyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gXG4gICAgICAgICQoJy5qcy1wYWdlLW5hdi1wb3B1cCAuanMtY2xvc2UnKS5jbGljayhmdW5jdGlvbiAoKXtcbiAgICAgICAgICAgICQoJy5qcy1wYWdlLW5hdi1wb3B1cCwgLmpzLXBhZ2UtbmF2LWlubmVyJykucmVtb3ZlQ2xhc3MoJy0tYWN0aXZlJyk7XG4gICAgICAgIH0pO1xuICAgICAgICBcblxuICAgICAgICAkKFwidmlkZW9bYXV0b3BsYXldXCIpLmVhY2goZnVuY3Rpb24oKXsgdGhpcy5wbGF5KCk7IH0pO1xuXG4gICAgICAgIGlmIChpbm5lcldpZHRoID4gMTAyNCkge1xuICAgICAgICAgICAgbGV0IG1haW5TbGlkZXIgPSBuZXcgU3dpcGVyKCcubWFpbi1zbGlkZXIgLnN3aXBlci1jb250YWluZXInLCB7XG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uOiAndmVydGljYWwnLFxuICAgICAgICAgICAgICAgIG1vdXNld2hlZWw6IHRydWUsXG4gICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMSxcbiAgICAgICAgICAgICAgICBwYWdpbmF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIGVsOiAnLnN3aXBlci1wYWdpbmF0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgY2xpY2thYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvbjoge1xuICAgICAgICAgICAgICAgICAgICBzbGlkZUNoYW5nZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXhfY3VycmVudFNsaWRlID0gdGhpcy5yZWFsSW5kZXg7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcuanMtbWFpbi1zbGlkZXItdGFicyBsaSBidXR0b24nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcuanMtbWFpbi1zbGlkZXItdGFicyBsaSBidXR0b25bZGF0YS1zbGlkZS1pbmRleD0nICsgKGluZGV4X2N1cnJlbnRTbGlkZSArIDEpICsgJ10nKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkKCcuanMtbWFpbi1zbGlkZXItdGFicyBsaSBidXR0b24nKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gJCh0aGlzKS5hdHRyKCdkYXRhLXNsaWRlLWluZGV4Jyk7XG4gICAgICAgICAgICAgICAgJCgnLmpzLW1haW4tc2xpZGVyLXRhYnMgbGkgYnV0dG9uJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgICQoJy5tYWluLXNsaWRlciAuc3dpcGVyLXBhZ2luYXRpb24tYnVsbGV0Om50aC1jaGlsZCgnICsgaW5kZXggKyAnKScpLmNsaWNrKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgICQoJy5qcy1uYXYtb3BlbicpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQodGhpcykudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgJCgnLmpzLWhlYWRlci1uYXYnKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICQoJy5qcy1zZXJ2aWNlcy1wb3B1cC1vcGVuZXInKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBsZXQgaW5kZXggPSAkKHRoaXMpLmF0dHIoJ2RhdGEtdGFiLWluZGV4Jyk7XG4gICAgICAgICAgICAkKCcuanMtc2VydmljZXMtcG9wdXAnKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAkKCcuanMtc2VydmljZXMtcG9wdXAtbmF2IGJ1dHRvbiwgLmpzLXNlcnZpY2VzLXBvcHVwLWNvbnRhaW5lcicpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICQoJy5qcy1zZXJ2aWNlcy1wb3B1cC1uYXYgYnV0dG9uW2RhdGEtdGFiLWluZGV4PVwiJyArIGluZGV4ICsgJ1wiXScpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICQoJy5qcy1zZXJ2aWNlcy1wb3B1cC1jb250YWluZXJbZGF0YS10YWItaW5kZXg9XCInICsgaW5kZXggKyAnXCJdJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB9KTtcblxuICAgICAgICAkKCcuanMtc2VydmljZXMtcG9wdXAtbmF2IGJ1dHRvbicpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGxldCBpbmRleCA9ICQodGhpcykuYXR0cignZGF0YS10YWItaW5kZXgnKTtcbiAgICAgICAgICAgICQoJy5qcy1zZXJ2aWNlcy1wb3B1cC1uYXYgYnV0dG9uLCAuanMtc2VydmljZXMtcG9wdXAtY29udGFpbmVyJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgJCgnLmpzLXNlcnZpY2VzLXBvcHVwLW5hdiBidXR0b25bZGF0YS10YWItaW5kZXg9XCInICsgaW5kZXggKyAnXCJdJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgJCgnLmpzLXNlcnZpY2VzLXBvcHVwLWNvbnRhaW5lcltkYXRhLXRhYi1pbmRleD1cIicgKyBpbmRleCArICdcIl0nKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICQoJy5qcy1zZXJ2aWNlcy1wb3B1cC1jbG9zZScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQoJy5qcy1zZXJ2aWNlcy1wb3B1cCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJCgnLmpzLXN0b3JlLXRhYnMgYnV0dG9uJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbGV0IGluZGV4ID0gJCh0aGlzKS5hdHRyKCdkYXRhLXN0b3JlLXNsaWRlci1pbmRleCcpO1xuICAgICAgICAgICAgJCgnLmpzLXN0b3JlLXRhYnMgYnV0dG9uLCAuanMtc3RvcmUtc2xpZGVyJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgJCgnLmpzLXN0b3JlLXNsaWRlcltkYXRhLXN0b3JlLXNsaWRlci1pbmRleD1cIicgKyBpbmRleCArICdcIl0nKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAkKCcuanMtc3RvcmUtdGFicyBidXR0b25bZGF0YS1zdG9yZS1zbGlkZXItaW5kZXg9XCInICsgaW5kZXggKyAnXCJdJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgc3RvcmVTbGlkZXJzID0gJCgnLmpzLXN0b3JlLXNsaWRlcicpO1xuXG4gICAgICAgIGlmIChzdG9yZVNsaWRlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBzdG9yZVNsaWRlcnMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gJCh0aGlzKS5hdHRyKCdkYXRhLXN0b3JlLXNsaWRlci1pbmRleCcpO1xuICAgICAgICAgICAgICAgIGxldCBzdG9yZVNsaWRlciA9IG5ldyBTd2lwZXIoJy5qcy1zdG9yZS1zbGlkZXJbZGF0YS1zdG9yZS1zbGlkZXItaW5kZXg9XCInICsgaW5kZXggKyAnXCJdIC5zd2lwZXItY29udGFpbmVyJywge1xuICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb246ICdob3Jpem9udGFsJyxcbiAgICAgICAgICAgICAgICAgICAgbW91c2V3aGVlbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDEuOCxcbiAgICAgICAgICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAxMixcbiAgICAgICAgICAgICAgICAgICAgcGFnaW5hdGlvbjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIG5hdmlnYXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRFbDogJy5qcy1zdG9yZS1zbGlkZXJbZGF0YS1zdG9yZS1zbGlkZXItaW5kZXg9XCInICsgaW5kZXggKyAnXCJdIC5qcy1zdG9yZS1zbGlkZXItbmV4dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2RWw6ICcuanMtc3RvcmUtc2xpZGVyW2RhdGEtc3RvcmUtc2xpZGVyLWluZGV4PVwiJyArIGluZGV4ICsgJ1wiXSAuanMtc3RvcmUtc2xpZGVyLXByZXYnXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICA3Njg6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiA0LFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdGVhbVNsaWRlciA9IG5ldyBTd2lwZXIoJy5qcy10ZWFtLXNsaWRlciAuc3dpcGVyLWNvbnRhaW5lcicsIHtcbiAgICAgICAgICAgIGRpcmVjdGlvbjogJ2hvcml6b250YWwnLFxuICAgICAgICAgICAgbW91c2V3aGVlbDogZmFsc2UsXG4gICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAxLjEsXG4gICAgICAgICAgICBzcGFjZUJldHdlZW46IDEyLFxuICAgICAgICAgICAgcGFnaW5hdGlvbjogZmFsc2UsXG4gICAgICAgICAgICBuYXZpZ2F0aW9uOiB7XG4gICAgICAgICAgICAgICAgbmV4dEVsOiAnLmpzLXRlYW0tc2xpZGVyLW5leHQnLFxuICAgICAgICAgICAgICAgIHByZXZFbDogJy5qcy10ZWFtLXNsaWRlci1wcmV2J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJyZWFrcG9pbnRzOiB7XG4gICAgICAgICAgICAgICAgNzY4OiB7XG4gICAgICAgICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDMsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJCh3aW5kb3cpLm9uKCdzY3JvbGwnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBsZXQgc3QgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XG4gICAgICAgICAgICBsZXQgc2VjdGlvbiA9ICQoJy5iaW9tYWNoaW5lLWZ1dHVyZScpXG4gICAgICAgICAgICBsZXQgc2VjdGlvblNUID0gc2VjdGlvbi5vZmZzZXQoKS50b3A7XG4gICAgICAgICAgICBsZXQgc2VjdGlvbkhlaWdodCA9IHNlY3Rpb24uaGVpZ2h0KCk7XG4gICAgICAgICAgICBsZXQgd2luZG93SGVpZ2h0ID0gJCh3aW5kb3cpLmhlaWdodCgpO1xuICAgICAgICAgICAgbGV0IHBvaW50ID0gKHNlY3Rpb25TVCArIHNlY3Rpb25IZWlnaHQpO1xuXG4gICAgICAgICAgICBpZiAoc3QgPj0gcG9pbnQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2hhbmdlIGZvb3RlcicpXG4gICAgICAgICAgICAgICAgJCgnLmZvb3RlcicpLmFkZENsYXNzKCctLXZpc2libGUnKTtcbiAgICAgICAgICAgICAgICAkKCcuYmlvbWFjaGluZS1zdHJpbmdfX2JnJykuYWRkQ2xhc3MoJy0tdmlzaWJsZScpO1xuICAgICAgICAgICAgICAgICQoJy5qcy1wYWdlLW5hdicpLmFkZENsYXNzKCctLWhpZGRlbicpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkKCcuYmlvbWFjaGluZS1zdHJpbmdfX2JnJykucmVtb3ZlQ2xhc3MoJy0tdmlzaWJsZScpO1xuICAgICAgICAgICAgICAgICQoJy5mb290ZXInKS5yZW1vdmVDbGFzcygnLS12aXNpYmxlJyk7XG4gICAgICAgICAgICAgICAgJCgnLmpzLXBhZ2UtbmF2JykucmVtb3ZlQ2xhc3MoJy0taGlkZGVuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgICQod2luZG93KS5vbignc2Nyb2xsJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbGV0IHN0ID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpO1xuICAgICAgICAgICAgbGV0IHNlY3Rpb24gPSAkKCcuanMtc3RvcmUtc2VjdGlvbicpXG4gICAgICAgICAgICBsZXQgc2VjdGlvblNUID0gc2VjdGlvbi5vZmZzZXQoKS50b3A7XG4gICAgICAgICAgICBsZXQgcG9pbnQgPSBzZWN0aW9uU1QgLSA0MDA7XG5cbiAgICAgICAgICAgIGlmIChzdCA+PSBwb2ludCkge1xuICAgICAgICAgICAgICAgIHNlY3Rpb24ucmVtb3ZlQ2xhc3MoJy0taW52ZXJ0ZWQnKTtcbiAgICAgICAgICAgICAgICAkKCcuYmlvbWFjaGluZS1wcm9tby4tLWxhc3QnKS5hZGRDbGFzcygnLS1pbnZlcnRlZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWN0aW9uLmFkZENsYXNzKCctLWludmVydGVkJyk7XG4gICAgICAgICAgICAgICAgJCgnLmJpb21hY2hpbmUtcHJvbW8uLS1sYXN0JykucmVtb3ZlQ2xhc3MoJy0taW52ZXJ0ZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cblxuICAgICAgICAkKCcuYmlvbWFjaGluZS1zdHJpbmdfX2l0ZW0nKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGxldCBpdGVtID0gdGhpcztcblxuICAgICAgICAgICAgJCh3aW5kb3cpLm9uKCdzY3JvbGwnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbGV0IGhlaWdodCA9ICQod2luZG93KS5oZWlnaHQoKTtcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBoZWlnaHQgLSAxNTA7XG4gICAgICAgICAgICAgICAgbGV0IHZpZXdwb3J0T2Zmc2V0ID0gaXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgICAgICBsZXQgdG9wID0gdmlld3BvcnRPZmZzZXQudG9wIC0gaGVpZ2h0O1xuICAgICAgICAgICAgICAgIGlmICgodG9wICsgMTUwKSA8PSAwICYmICh0b3AgKyAxNTApID49IC1NYXRoLmFicyhoZWlnaHQgLyAyKSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgcGVyY2VudCA9ICh0b3AgKiAxMDApIC8gaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICBwZXJjZW50ID0gK01hdGguYWJzKHBlcmNlbnQpO1xuICAgICAgICAgICAgICAgICAgICBwZXJjZW50ID0gTWF0aC5yb3VuZChwZXJjZW50KTtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSAwO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHBlcmNlbnQgKiAyO1xuICAgICAgICAgICAgICAgICAgICAkKGl0ZW0pLmNzcygnb3BhY2l0eScsIHZhbHVlIC8gMTAwKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAocGVyY2VudCA+PSA0MCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJChpdGVtKS5yZW1vdmVDbGFzcygnLS1vcGFjaXR5Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoKHRvcCArIDE1MCkgPD0gLU1hdGguYWJzKGhlaWdodCAvIDIpICYmICh0b3AgKyAxNTApID49IC1NYXRoLmFicyhoZWlnaHQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwZXJjZW50ID0gKHRvcCAqIDEwMCkgLyBoZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIHBlcmNlbnQgPSArTWF0aC5hYnMocGVyY2VudCk7XG4gICAgICAgICAgICAgICAgICAgIHBlcmNlbnQgPSBNYXRoLnJvdW5kKHBlcmNlbnQpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSAwO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAocGVyY2VudCA+PSA1MCAmJiBwZXJjZW50IDwgNTUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gMC45O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBlcmNlbnQgPj0gNTUgJiYgcGVyY2VudCA8IDYwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IDAuODtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwZXJjZW50ID49IDYwICYmIHBlcmNlbnQgPCA2NSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAwLjc7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGVyY2VudCA+PSA2NSAmJiBwZXJjZW50IDwgNzApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gMC42O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBlcmNlbnQgPj0gNzAgJiYgcGVyY2VudCA8IDc1KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IDAuNTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwZXJjZW50ID49IDc1ICYmIHBlcmNlbnQgPCA4MCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAwLjQ7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGVyY2VudCA+PSA4MCAmJiBwZXJjZW50IDwgODUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gMC4zO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBlcmNlbnQgPj0gODUgJiYgcGVyY2VudCA8IDkwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IDAuMjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwZXJjZW50ID49IDkwICYmIHBlcmNlbnQgPCA5NSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAwLjE7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGVyY2VudCA+PSA5MCAmJiBwZXJjZW50IDwgMTAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoJChpdGVtKS5oYXNDbGFzcygnLS1sYXN0JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy5iaW9tYWNoaW5lLXN0cmluZ19fYmcnKS5jc3MoJ29wYWNpdHknLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAkKGl0ZW0pLmNzcygnb3BhY2l0eScsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSlcblxuICAgIH0pO1xufSk7Il19